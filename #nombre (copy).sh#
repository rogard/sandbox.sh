# !/bin/bash

root=".."
identifiant_dir="$root/identifiant"
target_dir="$root/nombre"
pattern_exclude='@'

#!/bin/bash
# source "$(dirname "${BASH_SOURCE[0]}")/../error_exit"

help()
{
    echo "Search inside pdf's first page."
    echo
    echo "Syntax: pdf-search-1.sh [-h|--help] directory pattern "
    echo "options:"
    echo "h     Print this Help."
    echo "stdout:"
    echo path\tfound
    echo
}

# https://stackoverflow.com/a/14203146/9243116
POSITIONAL_ARGS=()
while [[ $# -gt 0 ]]; do
    case $1 in
        -h|--help)
            help
            exit 0
            ;;
        -*|--*)
            echo "Unknown option $1"
            exit 1
            ;;
        *)
            POSITIONAL_ARGS+=("$1") # save positional arg
            shift # past argument
            ;;
    esac
done
set -- "${POSITIONAL_ARGS[@]}"


>"$info"

find "$identifiant_dir" -mindepth 1 -type d\
    | while IFS= read -r path;\
    do empty_count=$(find "$path" -type f -empty | wc -l);
       id="${path##*/}"
       target="$target_dir/$empty_count.md"
       printf "%s\n" "[$id:]($identifiant_dir/$id)" | tee -a "$target"
    done
     #| sort | uniq | tee "$info"
